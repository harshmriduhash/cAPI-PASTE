<!DOCTYPE html>
<html>
<head>
    <title></title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <!-- <link rel="stylesheet" href="https://bootswatch.com/4/flatly/bootstrap.min.css" crossorigin="anonymous"> -->
    <link rel="stylesheet" type="text/css" href="../style.css">

<style type="text/css">
#randomGif {
    margin-left: 15px;
}
</style>

</head>

<body>

<nav class="navbar" id="importHeader">

<div class="container" style="margin-top: 6px;">
    <div class="container" style="text-align: right;">
      <button type="button" class="btn btn-info btn-md" data-toggle="modal" data-target="#myModal">Login to cAPI Paste</button>
    </div>  

    <div id="logged-user"></div>


      <!-- Modal -->
      <div class="modal fade" id="myModal" role="dialog">
        <div class="modal-dialog">
        
          <!-- Modal content-->
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal">&times;</button>
              <h4 class="modal-title">cAPI Paste</h4>

            </div>
            <div class="modal-body">
               <label><b>Email</b></label>
                <input id="email-text" type="email" placeholder="Enter Email">

                <label><b>Password</b></label>
                <input id="password-text" type="password" placeholder="Enter Password">

                <button class="btn btn-md btn-success" type="submit" id="submit-up">Login</button>

                <div id="login-errors"></div>

                <div><h5><a href="createaccount.html">Create Account</a></h5></div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
          </div>
          
        </div>
      </div>
      


  </div>
</nav>

<div class="wrapper" id="importInfoContainer">

<div class="container info-container">
    <div class="row remove-margin small-bottom-margin">
        <img class="user-icon" id="user-icon-change" src="http://via.placeholder.com/350x150">
        <h4><span id="pageTitle-change"></span><br><small><span id="APIType-change"></span> API Snippet by <a id="username-change" href="#" title="JonP Profile">JonP</a></small>
        </h4>
    </div>
    <div id="append-tags" class="row remove-margin small-bottom-margin">
    </div>
    <div class="row remove-margin">
        <button id="preview-button" class="myButton">Preview</button>
        <button id="html-button" class="myButton">HTML</button>
        <button id="css-button" class="myButton">CSS</button>
        <button id="js-button" class="myButton">JS</button>
    </div>
</div>

<div class="container playground">

    <div class="website-preview-container">
        <div id="website-preview">
            <div id="randomGif"></div>
        </div>
    </div>

    <div id="editor-html">&lt;!-- Links for JQuery and Bootstrap. You can put these in the Head of your HTML file --&gt;&#10;&lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js&quot;&gt;&lt;/script&gt;&#10;&#10;&lt;link rel=&quot;stylesheet&quot; href=&quot;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css&quot; integrity=&quot;sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u&quot; crossorigin=&quot;anonymous&quot;&gt;&#10;&#10;&lt;!-- Put this Div where you want the gifs to appear on your site --&gt;&#10;&lt;div id=&quot;randomGif&quot;&gt;&lt;/div&gt;</div>

    <div id="editor-css">.imgWidth {&#10;&#9;width: 100%;&#10;&#9;height: auto;&#10;&#9;margin-bottom: 0px;&#10;}</div>

    <div id="editor-javascript">//Code for AJAX request and appending images&#10;custom = &#39;cats&#39;;&#10;imagecount = &#39;20&#39;;&#10;randomGif = Math.floor(Math.random()*imagecount);&#10;&#10;//Code for AJAX request and appending images&#10;function getgifs(){&#10;$(&#39;#gifs&#39;).empty();&#10;offset = 0;&#10;var queryURL = &#39;https://api.giphy.com/v1/gifs/search?q=&#39;+custom+&#39;&amp;api_key=dc6zaTOxFJmzC&amp;MPAA=R&amp;limit=&#39;+imagecount+&#39;&#39;&#10;$.ajax({&#10;&#9;    url: queryURL,&#10;&#9;    method: &quot;GET&quot;&#10;    }).done(function(response) {&#10;&#9;&#9;if(response.data.length&lt;1){&#10;            console.log(&#39;No Results&#39;);&#10;&#9;&#9;&#9;return&#10;&#9;&#9;}&#10;&#9;&#9;//Append gifs to page&#10;&#9;&#9;else {&#10;&#9;    &#9;$(&#39;#randomGif&#39;).append(&#39;&lt;div&gt;&lt;img class=&quot;margin-left&quot; src=&quot;&#39;+response.data[randomGif].images.downsized.url+&#39;&quot;&gt;&lt;/div&gt;&#39;);&#10;&#9;&#9;}&#10;&#9;&#9;//End Append gifs to page&#10;&#9;});&#10;}&#10;//End AJAX and gif append&#10;&#10;getgifs();</div>

</div>

<div class="container panelplayground" id="additional-instructions">
    <h3 class="remove-margin similar-capis">Additional Instructions:</h3>
    <p class="remove-margin">This utilizes Bootstrap Rows and Columns. This also uses JQuery. You can change the value of the 'custom' variable in the javascript to change what gifs you want to display. For example: 
    <br>custom = 'dogs';<br>
    will display gifs of dogs instead. Similarly, you can change imagecount for more images.</p>
</div>

<div class="container panelplayground">
    <h3 class="remove-margin similar-capis">Similar cAPIs:</h3>
    <div class="row">
        <div id="similar1" class="col-xs-3"></div>
        <div id="similar2" class="col-xs-3"></div>
        <div id="similar3" class="col-xs-3"></div>
        <div id="similar4" class="col-xs-3"></div>              
    </div>
</div>

<div class="push"></div>

<footer id="importFooter" class="footer"></footer>
</body>

<script src="https://www.gstatic.com/firebasejs/4.8.0/firebase.js"></script>
<script>
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyAoBqOGpNhrH9ba5arV455T2kzhsT3bZHw",
    authDomain: "capi-paste.firebaseapp.com",
    databaseURL: "https://capi-paste.firebaseio.com",
    projectId: "capi-paste",
    storageBucket: "capi-paste.appspot.com",
    messagingSenderId: "1002672238599"
  };
  firebase.initializeApp(config);
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="../scripts/importheaderfooter.js"></script>
<script src="../ace-builds/src-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript">

pageTitle = 'Giphy Random Gif';
pageURL = 'GiphyRandomGif.html';
APIType = 'Gyphy';
tags = ['giphy', 'javascript', 'html', 'css', 'animated', 'gifs', 'ajax', 'random'];
submitter = 'JonP';
preview = '/pageimages/GiphyRandomGif.png'

dbUsers = firebase.database().ref('/userdata');
dbCurrentUser = firebase.database().ref('/userdata/' +submitter);

dbPages = firebase.database().ref('/pagedata');
dbCurrentPage = firebase.database().ref('/pagedata/' +pageTitle);

function newUser(){
    dbCurrentUser.set({
        "Name": submitter,
        "Password": "poop",
        "Avatar": "image.url"
    })
}
newUser();

dbUsers.on('value', snap=>{
    console.log(snap.val());
})

function updatePage(){
    dbCurrentPage.set({
        Name: pageTitle,
        URL: pageURL,
        previewURL: preview,
        API: APIType,
        Tags: tags,
        submittedBy: submitter
    })
}

updatePage();

appendNo = 1;

dbPages.on('child_added', snap=>{
    // tempArray = snap.val();
    console.log(snap.val());
    if(tags[0] == snap.val().Tags[0] && appendNo < 5 && pageTitle != snap.val().Name){
        $('#similar'+appendNo).append('<a href="'+snap.val().URL+'"><div class="panel panel-default"><div class="panel-heading"><h3 class="panel-title">'+snap.val().Name+'</h3></div><div class="panel-body"><img class="imgWidth" src="..'+snap.val().previewURL+'"></div></div></a>');
        appendNo++;
    }
})

dbUsers.on('child_added', snap=>{
// console.log(snap.val().username);
    if(submitter == snap.val().username){
        $('#user-icon-change').attr('src', '..'+snap.val().img);
    }
})

//Code for AJAX request and appending images
custom = 'cats';
imagecount = '20';
randomGif = Math.floor(Math.random()*imagecount);

//Code for AJAX request and appending images
function getgifs(){
$('#gifs').empty();
offset = 0;
var queryURL = 'https://api.giphy.com/v1/gifs/search?q='+custom+'&api_key=dc6zaTOxFJmzC&MPAA=R&limit='+imagecount+''
$.ajax({
	    url: queryURL,
	    method: "GET"
    }).done(function(response) {
		if(response.data.length<1){
            console.log('No Results');
			return
		}
		//Append gifs to page
		else {
	    	$('#randomGif').append('<div><img class="margin-left" src="'+response.data[randomGif].images.downsized.url+'"></div>');
		}
		//End Append gifs to page
	});
}
//End AJAX and gif append

getgifs();

</script>
<script src="../scripts/capis.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="../auth.js"></script>
</html>